FROM oven/bun:1 AS build

WORKDIR /app
COPY frontend/package.json frontend/bun.lock ./
RUN bun install --frozen-lockfile

COPY frontend/ .
RUN bun run build

FROM node:22-slim

WORKDIR /app
COPY --from=build /app/build ./build
COPY --from=build /app/package.json .

EXPOSE 3000
ENV PORT=3000

CMD ["node", "build/index.js"]
